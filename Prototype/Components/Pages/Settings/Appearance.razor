@page "/settings/appearance"
@using Telerik.Blazor
@using Telerik.Blazor.Components
@using System.Text.Json
@inject IJSRuntime JS
@inject NavigationManager Nav

<PageTitle>Appearance - IBN Dealer Suite</PageTitle>

<div class="appearance-wrapper">
    <main class="main-content appearance-page">
        <div class="page-header">
            <div class="header-content">
                <h1 class="title">Appearance</h1>
                <p class="subtitle">Customize how IBN Dealer Suite looks and feels</p>
            </div>
            <div class="header-actions">
                <div class="preset-dropdown">
                    <TelerikDropDownList Data="@presets"
                                         @bind-Value="@selectedPreset"
                                         TextField="Name"
                                         ValueField="Id"
                                         OnChange="@ApplyPreset"
                                         Width="180px">
                        <DropDownListSettings>
                            <DropDownListPopupSettings Height="auto" />
                        </DropDownListSettings>
                    </TelerikDropDownList>
                </div>
            </div>
        </div>

        <div class="settings-container">
            <!-- Theme Selection -->
            <section class="settings-section">
                <div class="section-header">
                    <TelerikSvgIcon Icon="@SvgIcon.Palette" />
                    <div class="section-title-group">
                        <h2>Theme</h2>
                        <p class="section-description">Choose your preferred color scheme</p>
                    </div>
                </div>
                <div class="section-content">
                    <div class="theme-grid">
                        <div class="theme-card @(selectedTheme == "light" ? "active" : "")"
                             @onclick="@(() => SelectTheme("light"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview light-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Light</h3>
                                <p>Clean and bright interface</p>
                            </div>
                            @if (selectedTheme == "light")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "dim" ? "active" : "")"
                             @onclick="@(() => SelectTheme("dim"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview dim-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Dim</h3>
                                <p>Softer, muted tones</p>
                            </div>
                            @if (selectedTheme == "dim")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "dark" ? "active" : "")"
                             @onclick="@(() => SelectTheme("dark"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview dark-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Dark</h3>
                                <p>Easy on the eyes in low light</p>
                            </div>
                            @if (selectedTheme == "dark")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "colorful" ? "active" : "")"
                             @onclick="@(() => SelectTheme("colorful"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview colorful-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar accent-bar"></div>
                                        <div class="preview-bar short accent-bar-alt"></div>
                                        <div class="preview-bar accent-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Colorful</h3>
                                <p>Vibrant and energetic</p>
                            </div>
                            @if (selectedTheme == "colorful")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "sepia" ? "active" : "")"
                             @onclick="@(() => SelectTheme("sepia"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview sepia-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Sepia</h3>
                                <p>Warm, paper-like tones</p>
                            </div>
                            @if (selectedTheme == "sepia")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "nord" ? "active" : "")"
                             @onclick="@(() => SelectTheme("nord"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview nord-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Nord</h3>
                                <p>Arctic, cool-toned palette</p>
                            </div>
                            @if (selectedTheme == "nord")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "midnight" ? "active" : "")"
                             @onclick="@(() => SelectTheme("midnight"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview midnight-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Midnight</h3>
                                <p>True black for OLED</p>
                            </div>
                            @if (selectedTheme == "midnight")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "high-contrast" ? "active" : "")"
                             @onclick="@(() => SelectTheme("high-contrast"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview high-contrast-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>High Contrast</h3>
                                <p>Maximum accessibility</p>
                            </div>
                            @if (selectedTheme == "high-contrast")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <!-- Add after the "auto" theme card -->

                        <div class="theme-card @(selectedTheme == "dracula" ? "active" : "")"
                             @onclick="@(() => SelectTheme("dracula"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview dracula-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Dracula</h3>
                                <p>Popular purple/pink/cyan palette</p>
                            </div>
                            @if (selectedTheme == "dracula")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "solarized-light" ? "active" : "")"
                             @onclick="@(() => SelectTheme("solarized-light"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview solarized-light-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Solarized Light</h3>
                                <p>Scientifically designed for comfort</p>
                            </div>
                            @if (selectedTheme == "solarized-light")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "solarized-dark" ? "active" : "")"
                             @onclick="@(() => SelectTheme("solarized-dark"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview solarized-dark-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Solarized Dark</h3>
                                <p>Dark variant with precision colors</p>
                            </div>
                            @if (selectedTheme == "solarized-dark")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "monochrome" ? "active" : "")"
                             @onclick="@(() => SelectTheme("monochrome"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview monochrome-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Monochrome</h3>
                                <p>Pure grayscale focus</p>
                            </div>
                            @if (selectedTheme == "monochrome")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "catppuccin" ? "active" : "")"
                             @onclick="@(() => SelectTheme("catppuccin"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview catppuccin-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Catppuccin</h3>
                                <p>Trendy pastel dark theme</p>
                            </div>
                            @if (selectedTheme == "catppuccin")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "catppuccin-latte" ? "active" : "")"
                             @onclick="@(() => SelectTheme("catppuccin-latte"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview catppuccin-latte-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Catppuccin Latte</h3>
                                <p>Light pastel elegance</p>
                            </div>
                            @if (selectedTheme == "catppuccin-latte")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "catppuccin-frappe" ? "active" : "")"
                             @onclick="@(() => SelectTheme("catppuccin-frappe"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview catppuccin-frappe-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Catppuccin Frappe</h3>
                                <p>Subdued dark palette</p>
                            </div>
                            @if (selectedTheme == "catppuccin-frappe")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "catppuccin-macchiato" ? "active" : "")"
                             @onclick="@(() => SelectTheme("catppuccin-macchiato"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview catppuccin-macchiato-preview">
                                <div class="preview-header"></div>
                                <div class="preview-content">
                                    <div class="preview-sidebar"></div>
                                    <div class="preview-main">
                                        <div class="preview-bar"></div>
                                        <div class="preview-bar short"></div>
                                        <div class="preview-bar"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Catppuccin Macchiato</h3>
                                <p>Medium contrast comfort</p>
                            </div>
                            @if (selectedTheme == "catppuccin-macchiato")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>

                        <div class="theme-card @(selectedTheme == "auto" ? "active" : "")"
                             @onclick="@(() => SelectTheme("auto"))"
                             @onclick:stopPropagation="true">
                            <div class="theme-preview auto-preview">
                                <div class="preview-split">
                                    <div class="preview-half light-preview">
                                        <div class="preview-header"></div>
                                        <div class="preview-content">
                                            <div class="preview-sidebar"></div>
                                            <div class="preview-main">
                                                <div class="preview-bar"></div>
                                                <div class="preview-bar short"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="preview-half dark-preview">
                                        <div class="preview-header"></div>
                                        <div class="preview-content">
                                            <div class="preview-sidebar"></div>
                                            <div class="preview-main">
                                                <div class="preview-bar"></div>
                                                <div class="preview-bar short"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="theme-info">
                                <h3>Auto</h3>
                                <p>Match system preferences</p>
                            </div>
                            @if (selectedTheme == "auto")
                            {
                                <div class="theme-check">
                                    <TelerikSvgIcon Icon="@SvgIcon.CheckCircle" />
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </section>

            <!-- Accent Color -->
            <section class="settings-section">
                <div class="section-header">
                    <TelerikSvgIcon Icon="@SvgIcon.DropletSlash" />
                    <div class="section-title-group">
                        <h2>Accent Color</h2>
                        <p class="section-description">Choose your preferred accent color for buttons and highlights</p>
                    </div>
                </div>
                <div class="section-content">
                    <div class="color-grid">
                        @foreach (var color in accentColors)
                        {
                            <button class="color-swatch @(selectedAccent == color.Value ? "active" : "")"
                                    style="background: @color.Color;"
                                    @onclick="@(() => SelectAccent(color.Value))"
                                    @onclick:stopPropagation="true"
                                    title="@color.Name"
                                    aria-label="@color.Name"
                                    type="button">
                                @if (selectedAccent == color.Value)
                                {
                                    <TelerikSvgIcon Icon="@SvgIcon.Check" Class="check-icon" />
                                }
                            </button>
                        }
                        <button class="color-swatch custom-color @(selectedAccent == "custom" ? "active" : "")"
                                style="background: @(selectedAccent == "custom" ? customAccentColor : "conic-gradient(red, yellow, lime, aqua, blue, magenta, red)");"
                                @onclick="@OpenColorPicker"
                                @onclick:stopPropagation="true"
                                title="Custom Color"
                                aria-label="Custom Color"
                                type="button">
                            @if (selectedAccent != "custom")
                            {
                                <TelerikSvgIcon Icon="@SvgIcon.Plus" Class="plus-icon" />
                            }
                            else
                            {
                                <TelerikSvgIcon Icon="@SvgIcon.Check" Class="check-icon" />
                            }
                        </button>
                    </div>
                    @if (showColorPicker)
                    {
                        <div class="custom-color-picker">
                            <TelerikColorPicker @bind-Value="@customAccentColor"
                                                ValueFormat="ColorFormat.Hex"
                                                ShowPreview="true"
                                                OnChange="@ApplyCustomColor" />
                        </div>
                    }
                </div>
            </section>

            <!-- Typography -->
            <section class="settings-section">
                <div class="section-header">
                    <TelerikSvgIcon Icon="@SvgIcon.FontFamily" />
                    <div class="section-title-group">
                        <h2>Typography</h2>
                        <p class="section-description">Customize fonts and text sizing</p>
                    </div>
                </div>
                <div class="section-content">
                    <div class="typography-grid">
                        <div class="setting-row">
                            <div class="setting-label">
                                <h4>Font Family</h4>
                                <p>Choose your preferred typeface</p>
                            </div>
                            <div class="setting-control">
                                <TelerikDropDownList Data="@fontFamilies"
                                                     @bind-Value="@selectedFont"
                                                     Width="200px" />
                            </div>
                        </div>

                        <div class="setting-row">
                            <div class="setting-label">
                                <h4>Base Font Size</h4>
                                <p>Adjust the default text size (@(fontSize)px)</p>
                            </div>
                            <div class="setting-control slider-control">
                                <span class="slider-label">A</span>
                                <TelerikSlider @bind-Value="@fontSize"
                                               Min="12"
                                               Max="20"
                                               SmallStep="1"
                                               LargeStep="2"
                                               Width="200px" />
                                <span class="slider-label large">A</span>
                            </div>
                        </div>

                        <div class="font-preview" style="font-family: @GetFontFamily(); font-size: @(fontSize)px;">
                            <p class="preview-text">The quick brown fox jumps over the lazy dog.</p>
                            <p class="preview-text small">0123456789 • ABCDEFGHIJKLMNOPQRSTUVWXYZ</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Display Density -->
            <section class="settings-section">
                <div class="section-header">
                    <TelerikSvgIcon Icon="@SvgIcon.Grid" />
                    <div class="section-title-group">
                        <h2>Display Density</h2>
                        <p class="section-description">Adjust spacing and element sizing</p>
                    </div>
                </div>
                <div class="section-content">
                    <div class="density-options">
                        <label class="density-option @(density == "compact" ? "active" : "")"
                               @onclick="@(() => SelectDensity("compact"))"
                               @onclick:stopPropagation="true">
                            <input type="radio"
                                   name="density"
                                   value="compact"
                                   checked="@(density == "compact")"
                                   @onchange="@(() => SelectDensity("compact"))" />
                            <div class="option-content">
                                <TelerikSvgIcon Icon="@SvgIcon.LayoutStacked" />
                                <div class="option-info">
                                    <h3>Compact</h3>
                                    <p>More content, less space</p>
                                </div>
                            </div>
                        </label>

                        <label class="density-option @(density == "comfortable" ? "active" : "")"
                               @onclick="@(() => SelectDensity("comfortable"))"
                               @onclick:stopPropagation="true">
                            <input type="radio"
                                   name="density"
                                   value="comfortable"
                                   checked="@(density == "comfortable")"
                                   @onchange="@(() => SelectDensity("comfortable"))" />
                            <div class="option-content">
                                <TelerikSvgIcon Icon="@SvgIcon.Grid" />
                                <div class="option-info">
                                    <h3>Comfortable</h3>
                                    <p>Balanced spacing (recommended)</p>
                                </div>
                            </div>
                        </label>

                        <label class="density-option @(density == "spacious" ? "active" : "")"
                               @onclick="@(() => SelectDensity("spacious"))"
                               @onclick:stopPropagation="true">
                            <input type="radio"
                                   name="density"
                                   value="spacious"
                                   checked="@(density == "spacious")"
                                   @onchange="@(() => SelectDensity("spacious"))" />
                            <div class="option-content">
                                <TelerikSvgIcon Icon="@SvgIcon.Layout" />
                                <div class="option-info">
                                    <h3>Spacious</h3>
                                    <p>Maximum breathing room</p>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>
            </section>

            <!-- Border Radius -->
            <section class="settings-section">
                <div class="section-header">
                    <TelerikSvgIcon Icon="@SvgIcon.BorderRadius" />
                    <div class="section-title-group">
                        <h2>Corner Style</h2>
                        <p class="section-description">Adjust the roundness of UI elements</p>
                    </div>
                </div>
                <div class="section-content">
                    <div class="radius-options">
                        @foreach (var option in radiusOptions)
                        {
                            <button class="radius-option @(borderRadius == option.Value ? "active" : "")"
                                    @onclick="@(() => SelectRadius(option.Value))"
                                    type="button">
                                <div class="radius-preview" style="border-radius: @option.Preview;"></div>
                                <span>@option.Name</span>
                            </button>
                        }
                    </div>
                </div>
            </section>

            <!-- Accessibility & Motion -->
            <section class="settings-section">
                <div class="section-header">
                    <TelerikSvgIcon Icon="@SvgIcon.Accessibility" />
                    <div class="section-title-group">
                        <h2>Accessibility & Motion</h2>
                        <p class="section-description">Customize animations and accessibility features</p>
                    </div>
                </div>
                <div class="section-content">
                    <div class="accessibility-settings">
                        <div class="toggle-row">
                            <div class="toggle-label">
                                <h4>Enable Animations</h4>
                                <p>Smooth transitions and micro-interactions</p>
                            </div>
                            <TelerikSwitch @bind-Value="@animations" />
                        </div>

@*                         <div class="toggle-row">
                            <div class="toggle-label">
                                <h4>Reduced Motion</h4>
                                <p>Minimize movement for motion sensitivity</p>
                            </div>
                            <TelerikSwitch @bind-Value="@reducedMotion" />
                        </div> *@

                        <div class="toggle-row">
                            <div class="toggle-label">
                                <h4>Show Grid Lines</h4>
                                <p>Display cell borders in data grids</p>
                            </div>
                            <TelerikSwitch @bind-Value="@showGridLines" />
                        </div>

@*                         <div class="toggle-row">
                            <div class="toggle-label">
                                <h4>Focus Indicators</h4>
                                <p>Enhanced focus outlines for keyboard navigation</p>
                            </div>
                            <TelerikSwitch @bind-Value="@focusIndicators" />
                        </div> *@

                        <div class="setting-row" style="margin-top: 1rem;">
                            <div class="setting-label">
                                <h4>Animation Speed</h4>
                                <p>Control the speed of animations (@(animationSpeed)x)</p>
                            </div>
                            <div class="setting-control slider-control">
                                <span class="slider-label">🐢</span>
                                <TelerikSlider @bind-Value="@animationSpeed"
                                               Min="0.5"
                                               Max="2.0"
                                               SmallStep="0.25"
                                               LargeStep="0.5"
                                               Width="180px"
                                               Enabled="@animations" />
                                <span class="slider-label">🐇</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Data & Settings Management -->
            <section class="settings-section">
                <div class="section-header">
                    <TelerikSvgIcon Icon="@SvgIcon.Gear" />
                    <div class="section-title-group">
                        <h2>Settings Management</h2>
                        <p class="section-description">Export, import, or reset your appearance settings</p>
                    </div>
                </div>
                <div class="section-content">
                    <div class="management-actions">

                        <button class="management-btn danger" @onclick="ResetToDefaults" type="button">
                            <TelerikSvgIcon Icon="@SvgIcon.ArrowRotateCcw" />
                            <div class="btn-text">
                                <h4>Reset to Defaults</h4>
                                <p>Restore all default settings</p>
                            </div>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Action Buttons -->
            <div class="settings-actions">
                <div class="action-info">
                    <TelerikSvgIcon Icon="@SvgIcon.InfoCircle" />
                    <span>Changes will apply after saving</span>
                </div>
                <div class="action-right">
                    <button class="btn" @onclick="Cancel" type="button">Cancel</button>
                    <button class="btn secondary" @onclick="PreviewChanges" type="button">
                        <TelerikSvgIcon Icon="@SvgIcon.Eye" />
                        Preview
                    </button>
                    <button class="btn primary" @onclick="SaveChanges" type="button">
                        <TelerikSvgIcon Icon="@SvgIcon.Save" />
                        Save Changes
                    </button>
                </div>
            </div>
        </div>
    </main>
</div>

@code {
        // Theme & Colors
    private string selectedTheme = "light";
    private string selectedAccent = "blue";
    private string customAccentColor = "#6366f1";
    private bool showColorPicker = false;

    // Typography
    private int fontSize = 14;
    private string selectedFont = "System Default";

    // Density & Layout
    private string density = "comfortable";
    private string borderRadius = "default";

    // Accessibility
    private bool animations = true;
    private bool reducedMotion = false;
    private bool showGridLines = true;
    private bool focusIndicators = true;
    private double animationSpeed = 1.0;

    // Presets
    private string selectedPreset = "";

    private List<string> fontFamilies = new()
{
    // Existing
    "System Default",
    "Helvetica Neue",
    "Segoe UI",
    "Inter",
    "Roboto",
    "Open Sans",
    "Source Sans Pro",
    "Lato",
    "Nunito",
    "Poppins",

    // Added — Fun / Playful
    "Comic Sans MS",
    "Papyrus",
    "Chalkboard SE",
    "Marker Felt",

    // Serif Classics
    "Times New Roman",
    "Georgia",
    "Garamond",
    "Baskerville",
    "Didot",

    // Sans-Serif Basics / UI Options
    "Arial",
    "Verdana",
    "Tahoma",
    "Trebuchet MS",
    "Futura",
    "Gill Sans",

    // Monospace
    "Consolas",
    "Courier New",
    "JetBrains Mono",
    "Menlo",
    "Fira Code",

    // Decorative / Oddballs
    "Copperplate",
    "Impact",
    "Lucida Handwriting",
    "Brush Script MT",
    "American Typewriter",
    "Snell Roundhand"
};


    private List<AccentColor> accentColors = new()
    {
        new("Blue", "#0c5ea8", "blue"),
        new("Indigo", "#4f46e5", "indigo"),
        new("Purple", "#7c3aed", "purple"),
        new("Pink", "#db2777", "pink"),
        new("Red", "#dc2626", "red"),
        new("Orange", "#ea580c", "orange"),
        new("Yellow", "#ca8a04", "yellow"),
        new("Green", "#16a34a", "green"),
        new("Teal", "#0d9488", "teal"),
        new("Cyan", "#0891b2", "cyan")
    };

    private List<RadiusOption> radiusOptions = new()
    {
        new("None", "none", "0"),
        new("Subtle", "subtle", "4px"),
        new("Default", "default", "8px"),
        new("Rounded", "rounded", "12px"),
        new("Extra", "extra", "16px"),
        new("Pill", "pill", "9999px")
    };

    private List<AppearancePreset> presets = new()
    {
        new("", "Select a preset..."),
        new("minimal", "Minimal"),
        new("professional", "Professional"),
        new("modern", "Modern"),
        new("accessibility", "Accessibility First"),
        new("compact-dark", "Compact Dark"),
        new("cozy-light", "Cozy Light")
    };

    protected override async Task OnInitializedAsync()
    {
        await LoadSettings();
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            try
            {
                await JS.InvokeVoidAsync("console.log", "Appearance page rendered");
            }
            catch (Exception ex)
            {
                Console.WriteLine($"OnAfterRenderAsync error: {ex.Message}");
            }
        }
    }

    private async Task LoadSettings()
    {
        try
        {
            selectedTheme = await GetSetting<string>("ibn-theme", "light");
            selectedAccent = await GetSetting<string>("ibn-accent", "blue");
            customAccentColor = await GetSetting<string>("ibn-customAccent", "#6366f1");
            density = await GetSetting<string>("ibn-density", "comfortable");
            fontSize = await GetSetting<int>("ibn-fontSize", 14);
            selectedFont = await GetSetting<string>("ibn-font", "System Default");
            animations = await GetSetting<bool>("ibn-animations", true);
            reducedMotion = await GetSetting<bool>("ibn-reducedMotion", false);
            showGridLines = await GetSetting<bool>("ibn-gridLines", true);
            borderRadius = await GetSetting<string>("ibn-borderRadius", "default");
            focusIndicators = await GetSetting<bool>("ibn-focusIndicators", true);
            animationSpeed = await GetSetting<double>("ibn-animationSpeed", 1.0);

            Console.WriteLine($"Loaded settings - Theme: {selectedTheme}, Accent: {selectedAccent}");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading settings: {ex.Message}");
        }
    }

    private async Task<T> GetSetting<T>(string key, T defaultValue)
    {
        try
        {
            var json = await JS.InvokeAsync<string>("localStorage.getItem", key);
            if (!string.IsNullOrEmpty(json))
            {
                return JsonSerializer.Deserialize<T>(json)!;
            }
        }
        catch { }
        return defaultValue;
    }

    private async Task SelectTheme(string theme)
    {
        selectedTheme = theme;
        await InvokeAsync(StateHasChanged);
    }

    private async Task SelectAccent(string accent)
    {
        selectedAccent = accent;
        showColorPicker = false;
        await InvokeAsync(StateHasChanged);
    }

    private void OpenColorPicker()
    {
        showColorPicker = !showColorPicker;
        if (showColorPicker)
        {
            selectedAccent = "custom";
        }
        StateHasChanged();
    }

    private void ApplyCustomColor()
    {
        selectedAccent = "custom";
        StateHasChanged();
    }

    private async Task SelectDensity(string value)
    {
        density = value;
        await InvokeAsync(StateHasChanged);
    }

    private async Task SelectRadius(string value)
    {
        borderRadius = value;
        await InvokeAsync(StateHasChanged);
    }

    private async Task ApplyPreset()
    {
        if (string.IsNullOrEmpty(selectedPreset)) return;

        switch (selectedPreset)
        {
            case "minimal":
                selectedTheme = "light";
                selectedAccent = "blue";
                density = "comfortable";
                borderRadius = "subtle";
                animations = true;
                fontSize = 14;
                break;
            case "professional":
                selectedTheme = "light";
                selectedAccent = "indigo";
                density = "comfortable";
                borderRadius = "default";
                animations = true;
                fontSize = 14;
                break;
            case "modern":
                selectedTheme = "dark";
                selectedAccent = "purple";
                density = "comfortable";
                borderRadius = "rounded";
                animations = true;
                fontSize = 15;
                break;
            case "accessibility":
                selectedTheme = "high-contrast";
                selectedAccent = "blue";
                density = "spacious";
                borderRadius = "default";
                animations = false;
                focusIndicators = true;
                fontSize = 16;
                break;
            case "compact-dark":
                selectedTheme = "midnight";
                selectedAccent = "cyan";
                density = "compact";
                borderRadius = "subtle";
                animations = true;
                fontSize = 13;
                break;
            case "cozy-light":
                selectedTheme = "sepia";
                selectedAccent = "orange";
                density = "spacious";
                borderRadius = "rounded";
                animations = true;
                fontSize = 16;
                break;
        }

        selectedPreset = "";
        await InvokeAsync(StateHasChanged);
    }

    private string GetFontFamily()
    {
        return selectedFont switch
        {
            // System Default
            "System Default" => "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",

            // Sans-serif UI / Modern
            "Helvetica Neue" => "'Helvetica Neue', Helvetica, Arial, sans-serif",
            "Segoe UI" => "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
            "Inter" => "'Inter', system-ui, sans-serif",
            "Roboto" => "'Roboto', sans-serif",
            "Open Sans" => "'Open Sans', sans-serif",
            "Source Sans Pro" => "'Source Sans Pro', sans-serif",
            "Lato" => "'Lato', sans-serif",
            "Nunito" => "'Nunito', sans-serif",
            "Poppins" => "'Poppins', sans-serif",
            "Arial" => "Arial, Helvetica, sans-serif",
            "Verdana" => "Verdana, Geneva, sans-serif",
            "Tahoma" => "Tahoma, Geneva, sans-serif",
            "Trebuchet MS" => "'Trebuchet MS', Helvetica, sans-serif",
            "Futura" => "'Futura', sans-serif",
            "Gill Sans" => "'Gill Sans', Calibri, sans-serif",

            // Fun / Playful
            "Comic Sans MS" => "'Comic Sans MS', 'Comic Sans', cursive",
            "Papyrus" => "'Papyrus', fantasy",
            "Chalkboard SE" => "'Chalkboard SE', 'Comic Sans MS', cursive",
            "Marker Felt" => "'Marker Felt', 'Comic Sans MS', cursive",

            // Serif
            "Times New Roman" => "'Times New Roman', Times, serif",
            "Georgia" => "Georgia, serif",
            "Garamond" => "'Garamond', serif",
            "Baskerville" => "'Baskerville', serif",
            "Didot" => "'Didot', serif",

            // Monospace
            "Consolas" => "'Consolas', 'Courier New', monospace",
            "Courier New" => "'Courier New', Courier, monospace",
            "JetBrains Mono" => "'JetBrains Mono', monospace",
            "Menlo" => "'Menlo', monospace",
            "Fira Code" => "'Fira Code', monospace",

            // Decorative
            "Copperplate" => "'Copperplate', 'Copperplate Gothic Light', serif",
            "Impact" => "Impact, Charcoal, sans-serif",
            "Lucida Handwriting" => "'Lucida Handwriting', cursive",
            "Brush Script MT" => "'Brush Script MT', cursive",
            "American Typewriter" => "'American Typewriter', serif",
            "Snell Roundhand" => "'Snell Roundhand', cursive",

            // Fallback
            _ => "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif"
        };
    }

    private async Task PreviewChanges()
    {
        await ApplySettingsToDOM();
    }

    private async Task ApplySettingsToDOM()
    {
        try
        {
            // Temporarily apply settings without saving
            await JS.InvokeVoidAsync("eval", $@"
                (function() {{
                    localStorage.setItem('ibn-theme', '{JsonSerializer.Serialize(selectedTheme)}');
                    localStorage.setItem('ibn-accent', '{JsonSerializer.Serialize(selectedAccent)}');
                    localStorage.setItem('ibn-density', '{JsonSerializer.Serialize(density)}');
                    localStorage.setItem('ibn-fontSize', '{fontSize}');
                    localStorage.setItem('ibn-font', '{JsonSerializer.Serialize(selectedFont)}');
                    localStorage.setItem('ibn-borderRadius', '{JsonSerializer.Serialize(borderRadius)}');
                    localStorage.setItem('ibn-animations', '{animations.ToString().ToLower()}');
                    localStorage.setItem('ibn-animationSpeed', '{animationSpeed}');
                    window.refreshAppearance?.();
                }})();
            ");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Preview error: {ex.Message}");
        }
    }

    private async Task SaveChanges()
    {
        try
        {
            await JS.InvokeVoidAsync("localStorage.setItem", "ibn-theme", JsonSerializer.Serialize(selectedTheme));
            await JS.InvokeVoidAsync("localStorage.setItem", "ibn-accent", JsonSerializer.Serialize(selectedAccent));
            await JS.InvokeVoidAsync("localStorage.setItem", "ibn-customAccent", JsonSerializer.Serialize(customAccentColor));
            await JS.InvokeVoidAsync("localStorage.setItem", "ibn-density", JsonSerializer.Serialize(density));
            await JS.InvokeVoidAsync("localStorage.setItem", "ibn-fontSize", JsonSerializer.Serialize(fontSize));
            await JS.InvokeVoidAsync("localStorage.setItem", "ibn-font", JsonSerializer.Serialize(selectedFont));
            await JS.InvokeVoidAsync("localStorage.setItem", "ibn-animations", JsonSerializer.Serialize(animations));
            await JS.InvokeVoidAsync("localStorage.setItem", "ibn-gridLines", JsonSerializer.Serialize(showGridLines));
            await JS.InvokeVoidAsync("localStorage.setItem", "ibn-borderRadius", JsonSerializer.Serialize(borderRadius));
            await JS.InvokeVoidAsync("localStorage.setItem", "ibn-animationSpeed", JsonSerializer.Serialize(animationSpeed));

            await JS.InvokeVoidAsync("eval", "window.refreshAppearance?.()");
            await JS.InvokeVoidAsync("console.log", "Settings saved successfully");

            Nav.NavigateTo("/");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error saving settings: {ex.Message}");
        }
    }

    private void Cancel()
    {
        Nav.NavigateTo("/");
    }

    private async Task ResetToDefaults()
    {
        selectedTheme = "light";
        selectedAccent = "blue";
        customAccentColor = "#6366f1";
        density = "comfortable";
        fontSize = 14;
        selectedFont = "System Default";
        animations = true;
        reducedMotion = false;
        showGridLines = true;
        borderRadius = "default";
        focusIndicators = false;
        animationSpeed = 1.0;
        await InvokeAsync(StateHasChanged);
    }

    public record AccentColor(string Name, string Color, string Value);
    public record RadiusOption(string Name, string Value, string Preview);
    public record AppearancePreset(string Id, string Name);
}

<style>
    /* Wrapper to ensure proper layout */
    .appearance-wrapper {
        min-height: 100vh;
        width: 100%;
        position: relative;
    }

    .appearance-page {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        color: var(--text);
        min-height: 100vh;
    }

    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 2px solid var(--nav-border);
    }

    .header-content .title {
        margin: 0 0 0.5rem 0;
        font-size: 2rem;
        font-weight: 700;
        color: var(--text);
    }

    .subtitle {
        margin: 0;
        font-size: 1rem;
        color: var(--muted);
    }

    .header-actions {
        display: flex;
        gap: 0.75rem;
    }

    .settings-container {
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }

    /* Section Styling */
    .settings-section {
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-sm);
        overflow: hidden;
    }

    .section-header {
        display: flex;
        align-items: flex-start;
        gap: 1rem;
        padding: 1.5rem;
        border-bottom: 1px solid var(--border);
    }

        .section-header .k-svg-icon {
            color: var(--accent);
            flex-shrink: 0;
            margin-top: 2px;
        }

    .section-title-group h2 {
        margin: 0 0 0.25rem 0;
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text);
    }

    .section-description {
        margin: 0;
        font-size: 0.875rem;
        color: var(--muted);
    }

    .section-content {
        padding: 1.5rem;
    }

    /* Theme Grid */
    .theme-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: 1rem;
    }

    .theme-card {
        position: relative;
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        overflow: hidden;
        cursor: pointer;
        transition: all var(--transition-normal) ease;
        background: var(--card-bg);
    }

        .theme-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .theme-card.active {
            border-color: var(--accent);
            border-width: 3px;
            box-shadow: 0 0 0 3px rgba(var(--accent-rgb), 0.2);
        }

    .theme-preview {
        height: 120px;
        padding: 10px;
        position: relative;
    }

    .light-preview {
        background: #ffffff;
    }

    .dim-preview {
        background: #3d4a5c;
    }

    .dark-preview {
        background: #111827;
    }

    .colorful-preview {
        background: linear-gradient(135deg, #faf5ff 0%, #fdf4ff 50%, #fce7f3 100%);
    }

    .sepia-preview {
        background: #f4ecd8;
    }

    .nord-preview {
        background: #2e3440;
    }

    .midnight-preview {
        background: #000000;
    }

    .high-contrast-preview {
        background: #ffffff;
        border: 2px solid #000000 !important;
    }

    .dracula-preview {
        background: #282a36;
    }

        .dracula-preview .preview-header {
            background: #ff79c6;
            opacity: 0.6;
        }

        .dracula-preview .preview-sidebar {
            background: #bd93f9;
            opacity: 0.5;
        }

        .dracula-preview .preview-bar {
            background: #f8f8f2;
            opacity: 0.2;
        }

    .solarized-light-preview {
        background: #fdf6e3;
    }

        .solarized-light-preview .preview-header {
            background: #93a1a1;
            opacity: 0.3;
        }

        .solarized-light-preview .preview-sidebar {
            background: #839496;
            opacity: 0.3;
        }

        .solarized-light-preview .preview-bar {
            background: #657b83;
            opacity: 0.3;
        }

    .solarized-dark-preview {
        background: #002b36;
    }

        .solarized-dark-preview .preview-header {
            background: #268bd2;
            opacity: 0.6;
        }

        .solarized-dark-preview .preview-sidebar {
            background: #2aa198;
            opacity: 0.5;
        }

        .solarized-dark-preview .preview-bar {
            background: #839496;
            opacity: 0.3;
        }

    .monochrome-preview {
        background: #ffffff;
    }

        .monochrome-preview .preview-header {
            background: #6a6a6a;
            opacity: 0.6;
        }

        .monochrome-preview .preview-sidebar {
            background: #a0a0a0;
            opacity: 0.5;
        }

        .monochrome-preview .preview-bar {
            background: #1a1a1a;
            opacity: 0.2;
        }

    .catppuccin-preview {
        background: #1e1e2e;
    }

        .catppuccin-preview .preview-header {
            background: linear-gradient(135deg, #cba6f7 0%, #b4befe 100%);
            opacity: 0.7;
        }

        .catppuccin-preview .preview-sidebar {
            background: linear-gradient(180deg, #89b4fa 0%, #b4befe 100%);
            opacity: 0.6;
        }

        .catppuccin-preview .preview-bar {
            background: #f5c2e7;
            opacity: 0.4;
        }

    /* CATPPUCCIN LATTE PREVIEW */
    .catppuccin-latte-preview {
        background: #eff1f5;
    }

        .catppuccin-latte-preview .preview-header {
            background: linear-gradient(135deg, #8839ef 0%, #7287fd 100%);
            opacity: 0.7;
        }

        .catppuccin-latte-preview .preview-sidebar {
            background: linear-gradient(180deg, #1e66f5 0%, #7287fd 100%);
            opacity: 0.6;
        }

        .catppuccin-latte-preview .preview-bar {
            background: #ea76cb;
            opacity: 0.4;
        }

    /* CATPPUCCIN FRAPPÉ PREVIEW */
    .catppuccin-frappe-preview {
        background: #303446;
    }

        .catppuccin-frappe-preview .preview-header {
            background: linear-gradient(135deg, #ca9ee6 0%, #babbf1 100%);
            opacity: 0.7;
        }

        .catppuccin-frappe-preview .preview-sidebar {
            background: linear-gradient(180deg, #8caaee 0%, #babbf1 100%);
            opacity: 0.6;
        }

        .catppuccin-frappe-preview .preview-bar {
            background: #f4b8e4;
            opacity: 0.4;
        }

    /* CATPPUCCIN MACCHIATO PREVIEW */
    .catppuccin-macchiato-preview {
        background: #24273a;
    }

        .catppuccin-macchiato-preview .preview-header {
            background: linear-gradient(135deg, #c6a0f6 0%, #b7bdf8 100%);
            opacity: 0.7;
        }

        .catppuccin-macchiato-preview .preview-sidebar {
            background: linear-gradient(180deg, #8aadf4 0%, #b7bdf8 100%);
            opacity: 0.6;
        }

        .catppuccin-macchiato-preview .preview-bar {
            background: #f5bde6;
            opacity: 0.4;
        }

    .preview-header {
        height: 18px;
        background: currentColor;
        border-radius: 4px;
        margin-bottom: 6px;
        opacity: 0.1;
    }

    .preview-content {
        display: flex;
        gap: 6px;
        height: calc(100% - 24px);
    }

    .preview-sidebar {
        width: 40px;
        background: currentColor;
        border-radius: 4px;
        opacity: 0.08;
    }

    .preview-main {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .preview-bar {
        height: 12px;
        background: currentColor;
        border-radius: 3px;
        opacity: 0.1;
    }

        .preview-bar.short {
            width: 60%;
        }

    .light-preview .preview-header,
    .light-preview .preview-sidebar,
    .light-preview .preview-bar {
        color: #111827;
    }

    .dim-preview .preview-header,
    .dim-preview .preview-sidebar,
    .dim-preview .preview-bar {
        color: #e2e8f0;
    }

    .dark-preview .preview-header,
    .dark-preview .preview-sidebar,
    .dark-preview .preview-bar {
        color: #f9fafb;
    }

    .colorful-preview .preview-header {
        background: linear-gradient(135deg, #f0abfc 0%, #c084fc 100%);
        opacity: 0.8;
    }

    .colorful-preview .preview-sidebar {
        background: linear-gradient(180deg, #e879f9 0%, #a855f7 100%);
        opacity: 0.6;
    }

    .colorful-preview .preview-bar {
        background: #d8b4fe;
        opacity: 0.7;
    }

    .sepia-preview .preview-header {
        background: #d4c4a8;
        opacity: 0.6;
    }

    .sepia-preview .preview-sidebar {
        background: #bfae8e;
        opacity: 0.5;
    }

    .sepia-preview .preview-bar {
        background: #8b7355;
        opacity: 0.3;
    }

    .nord-preview .preview-header {
        background: #88c0d0;
        opacity: 0.6;
    }

    .nord-preview .preview-sidebar {
        background: #5e81ac;
        opacity: 0.5;
    }

    .nord-preview .preview-bar {
        background: #d8dee9;
        opacity: 0.2;
    }

    .midnight-preview .preview-header {
        background: #27272a;
        opacity: 1;
    }

    .midnight-preview .preview-sidebar {
        background: #18181b;
        opacity: 1;
    }

    .midnight-preview .preview-bar {
        background: #3f3f46;
        opacity: 0.6;
    }

    .high-contrast-preview .preview-header {
        background: #000000;
        opacity: 1;
    }

    .high-contrast-preview .preview-sidebar {
        background: #000000;
        opacity: 1;
    }

    .high-contrast-preview .preview-bar {
        background: #000000;
        opacity: 1;
    }

        .high-contrast-preview .preview-bar.short {
            background: #ffff00;
        }

    .preview-split {
        display: flex;
        height: 100%;
    }

    .preview-half {
        flex: 1;
        padding: 8px;
    }

    .theme-info {
        padding: 0.75rem 1rem;
        background: var(--hover-bg);
    }

        .theme-info h3 {
            margin: 0 0 0.125rem 0;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
        }

        .theme-info p {
            margin: 0;
            font-size: 0.75rem;
            color: var(--muted);
        }

    .theme-check {
        position: absolute;
        top: 8px;
        right: 8px;
        width: 24px;
        height: 24px;
        background: var(--accent);
        color: white;
        border-radius: 50%;
        display: grid;
        place-items: center;
        box-shadow: var(--shadow-md);
    }

        .theme-check .k-svg-icon {
            width: 14px;
            height: 14px;
        }

    /* Color Grid */
    .color-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
        gap: 0.75rem;
        max-width: 600px;
    }

    .color-swatch {
        width: 100%;
        aspect-ratio: 1;
        border: 3px solid transparent;
        border-radius: var(--radius-lg);
        cursor: pointer;
        transition: all var(--transition-normal) ease;
        display: grid;
        place-items: center;
        box-shadow: var(--shadow-sm), inset 0 0 0 1px rgba(255, 255, 255, 0.1);
    }

        .color-swatch:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-lg);
        }

        .color-swatch.active {
            border-color: white;
            box-shadow: 0 0 0 3px var(--accent), var(--shadow-lg);
        }

        .color-swatch.custom-color {
            background-size: cover;
        }

    .check-icon, .plus-icon {
        color: white;
        font-size: 20px;
        filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.5));
    }

    .custom-color-picker {
        margin-top: 1rem;
        padding: 1rem;
        background: var(--hover-bg);
        border-radius: var(--radius-md);
        display: inline-block;
    }

    /* Typography */
    .typography-grid {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .setting-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 2rem;
    }

    .setting-label h4 {
        margin: 0 0 0.25rem 0;
        font-size: 0.95rem;
        font-weight: 600;
        color: var(--text);
    }

    .setting-label p {
        margin: 0;
        font-size: 0.8rem;
        color: var(--muted);
    }

    .slider-control {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .slider-label {
        font-size: 0.75rem;
        color: var(--muted);
    }

        .slider-label.large {
            font-size: 1.25rem;
        }

    .font-preview {
        padding: 1.25rem;
        background: var(--hover-bg);
        border-radius: var(--radius-md);
        border: 1px dashed var(--border);
    }

    .preview-text {
        margin: 0;
        line-height: 1.6;
        color: var(--text);
    }

        .preview-text.small {
            margin-top: 0.5rem;
            font-size: 0.85em;
            color: var(--muted);
        }

    /* Density Options */
    .density-options {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .density-option {
        display: block;
        padding: 1.25rem;
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        cursor: pointer;
        transition: all var(--transition-normal) ease;
        background: var(--card-bg);
    }

        .density-option:hover {
            border-color: var(--accent);
            background: var(--hover-bg);
        }

        .density-option.active {
            border-color: var(--accent);
            background: var(--accent-weak);
            box-shadow: 0 0 0 3px rgba(var(--accent-rgb), 0.15);
        }

        .density-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

    .option-content {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

        .option-content .k-svg-icon {
            color: var(--accent);
            font-size: 32px;
        }

    .option-info h3 {
        margin: 0 0 0.25rem 0;
        font-size: 1rem;
        font-weight: 600;
        color: var(--text);
    }

    .option-info p {
        margin: 0;
        font-size: 0.875rem;
        color: var(--muted);
    }

    /* Border Radius Options */
    .radius-options {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
    }

    .radius-option {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        padding: 1rem;
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        background: var(--card-bg);
        cursor: pointer;
        transition: all var(--transition-normal) ease;
        min-width: 80px;
    }

        .radius-option:hover {
            border-color: var(--accent);
            background: var(--hover-bg);
        }

        .radius-option.active {
            border-color: var(--accent);
            background: var(--accent-weak);
            box-shadow: 0 0 0 3px rgba(var(--accent-rgb), 0.15);
        }

    .radius-preview {
        width: 40px;
        height: 40px;
        background: var(--accent);
    }

    .radius-option span {
        font-size: 0.8rem;
        color: var(--text);
        font-weight: 500;
    }

    /* Layout Settings */
    .layout-settings {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    /* Accessibility Settings */
    .accessibility-settings {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .toggle-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        background: var(--hover-bg);
        border-radius: var(--radius-md);
    }

    .toggle-label h4 {
        margin: 0 0 0.25rem 0;
        font-size: 0.95rem;
        font-weight: 600;
        color: var(--text);
    }

    .toggle-label p {
        margin: 0;
        font-size: 0.8rem;
        color: var(--muted);
    }

    /* Management Actions */
    .management-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
    }

    .management-btn {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1.25rem;
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        background: var(--card-bg);
        cursor: pointer;
        transition: all var(--transition-normal) ease;
        text-align: left;
    }

        .management-btn:hover {
            border-color: var(--accent);
            background: var(--hover-bg);
        }

        .management-btn.danger:hover {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.08);
        }

        .management-btn .k-svg-icon {
            color: var(--accent);
            flex-shrink: 0;
        }

        .management-btn.danger .k-svg-icon {
            color: #ef4444;
        }

    .btn-text h4 {
        margin: 0 0 0.25rem 0;
        font-size: 0.95rem;
        font-weight: 600;
        color: var(--text);
    }

    .btn-text p {
        margin: 0;
        font-size: 0.75rem;
        color: var(--muted);
    }

    /* Settings Actions */
    .settings-actions {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1.5rem;
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        gap: 1rem;
        background: var(--card-bg);
    }

    .action-info {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--muted);
        font-size: 0.875rem;
    }

    .action-right {
        display: flex;
        gap: 0.75rem;
    }

    .btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.625rem 1.25rem;
        border: 1px solid var(--border);
        background: var(--card-bg);
        color: var(--text);
        font-size: 0.875rem;
        font-weight: 600;
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: all var(--transition-normal) ease;
    }

        .btn:hover {
            background: var(--hover-bg);
            border-color: var(--border-strong);
        }

        .btn.primary {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

            .btn.primary:hover {
                background: var(--accent-hover);
                border-color: var(--accent-hover);
            }

        .btn.secondary {
            background: transparent;
            color: var(--accent);
            border-color: var(--accent);
        }

            .btn.secondary:hover {
                background: var(--accent-weak);
            }

    /* Responsive */
    @@media (max-width: 768px) {
        .appearance-page

    {
        padding: 1rem;
    }

    .page-header {
        flex-direction: column;
        gap: 1rem;
    }

    .theme-grid {
        grid-template-columns: repeat(3, 1fr);
    }

    .color-grid {
        grid-template-columns: repeat(6, 1fr);
    }

    .setting-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
    }

    .settings-actions {
        flex-direction: column;
        align-items: stretch;
    }

    .action-right {
        flex-direction: column;
    }

    .btn {
        width: 100%;
        justify-content: center;
    }

    }

    @@media (max-width: 560px) {
        .theme-grid

    {
        grid-template-columns: repeat(2, 1fr);
    }

    .radius-options {
        justify-content: center;
    }

    }

    @@media (max-width: 380px) {
        .theme-grid

    {
        grid-template-columns: 1fr;
    }

    }
</style>