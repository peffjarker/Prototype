@page "/product/webcat"

@using System.Linq
@using Microsoft.AspNetCore.WebUtilities
@using Prototype.Components.Layout.Navigation.Sidebar
@using Prototype.Pages.Product.SeedData
@using Telerik.Blazor
@using Telerik.Blazor.Components
@using static Prototype.Pages.Product.SeedData.WebcatSeedData

@inherits PageWithSidebarBase

@inject IJSRuntime JS

<div class="wrap">
    <header class="header">
        <h3 class="title">Webcat - Item Availability</h3>
    </header>

    <!-- Filter Panel -->
    <section class="card filter-panel">
        <div class="filter-grid">
            <div class="filter-col">
                <div class="field">
                    <label>Class:</label>
                    <select @bind="SelectedClass" @bind:after="OnFilterChanged">
                        <option value="All Items">All Items</option>
                        <option value="CQT Stock">CQT Stock</option>
                        <option value="Local Only">Local Only</option>
                    </select>
                </div>

                <div class="field">
                    <label>Category:</label>
                    <select @bind="SelectedCategory" @bind:after="OnFilterChanged">
                        <option value="">All Categories</option>
                        @foreach (var cat in Categories)
                        {
                            <option value="@cat">@cat</option>
                        }
                    </select>
                </div>

                <div class="field">
                    <label>Subcategory:</label>
                    <select @bind="SelectedSubcategory"
                            @bind:after="OnFilterChanged"
                            disabled="@string.IsNullOrEmpty(SelectedCategory)">
                        <option value="">All Subcategories</option>
                        @foreach (var sub in SubcategoriesForSelectedCategory)
                        {
                            <option value="@sub">@sub</option>
                        }
                    </select>
                </div>

                <div class="field">
                    <label>Brand:</label>
                    <select @bind="SelectedBrand" @bind:after="OnFilterChanged">
                        <option value="">All Brands</option>
                        @foreach (var brand in Brands)
                        {
                            <option value="@brand">@brand</option>
                        }
                    </select>
                </div>
            </div>

            <div class="filter-col">
                <div class="field">
                    <label>Ship From:</label>
                    <select @bind="SelectedShipFrom" @bind:after="OnFilterChanged">
                        <option value="">All Locations</option>
                        @foreach (var loc in ShipFromLocations)
                        {
                            <option value="@loc">@loc</option>
                        }
                    </select>
                </div>

                <div class="field checkbox-field">
                    <label>
                        <input type="checkbox" @bind="DisplayDiscontinued" @bind:after="OnFilterChanged" />
                        Display Discontinued
                    </label>
                </div>

                <div class="field checkbox-field">
                    <label>
                        <input type="checkbox" @bind="OnlyShowInventory" @bind:after="OnFilterChanged" />
                        Only Show Items with Inventory
                    </label>
                </div>
            </div>
        </div>

        <div class="filter-actions">
            <button class="btn" @onclick="ClearFilters">Clear Filters</button>
            <span class="filter-summary">
                Showing @FilteredItems.Count of @AllItems.Count items
            </span>
        </div>
    </section>

    <!-- Items List & Detail -->
    <section class="card items-section">
        <div class="items-layout">
            <!-- Items List -->
            <div class="items-list">
                <div class="list-header">
                    <input type="text" class="search-box" placeholder="Search items..."
                           @bind="SearchText" @bind:event="oninput" />
                </div>
                <div class="list-body">
                    @foreach (var item in DisplayedItems)
                    {
                        <div class="item-row @(item.Item == SelectedItemNumber ? "selected" : "") @GetItemStatusClass(item)"
                             @onclick="() => SelectItem(item.Item)">
                            <div class="item-number">@item.Item</div>
                            <div class="item-name">@item.Description</div>
                            @if (item.IsDiscontinued)
                            {
                                <span class="item-badge disc">●</span>
                            }
                            @if (item.IsPriceConfirm)
                            {
                                <span class="item-badge price">●</span>
                            }
                            @if (item.IsDropShip)
                            {
                                <span class="item-badge ds">●</span>
                            }
                        </div>
                    }
                </div>
            </div>

            <!-- Item Detail -->
            <div class="item-detail">
                @if (SelectedItem != null)
                {
                    <div class="detail-header">
                        <h4>@SelectedItem.Item - @SelectedItem.Description</h4>
                    </div>

                    <div class="detail-grid">
                        <div class="detail-section">
                            <div class="field-row">
                                <div class="field">
                                    <label>Item:</label>
                                    <input readonly value="@SelectedItem.Item" />
                                </div>
                                <div class="field">
                                    <label>Discount:</label>
                                    <select disabled>
                                        <option>@SelectedItem.Discount</option>
                                    </select>
                                </div>
                            </div>

                            <div class="field">
                                <label>Description:</label>
                                <input readonly value="@SelectedItem.Description" />
                            </div>

                            <div class="field-row">
                                <div class="field">
                                    <label>List Price:</label>
                                    <input readonly value="@SelectedItem.ListPrice.ToString("C")" />
                                </div>
                                <div class="field checkbox-field">
                                    <label>Drop Ship:</label>
                                    <input type="checkbox" checked="@SelectedItem.IsDropShip" disabled />
                                </div>
                            </div>

                            <div class="field-row">
                                <div class="field">
                                    <label>Warranty:</label>
                                    <input readonly value="@SelectedItem.Warranty" />
                                </div>
                                <div class="field">
                                    <label>Action:</label>
                                    <input readonly value="@SelectedItem.Action" />
                                </div>
                            </div>

                            <div class="field-row">
                                <div class="field">
                                    <label>Status:</label>
                                    <input readonly value="@SelectedItem.Status" />
                                </div>
                                <div class="field">
                                    <label>Category:</label>
                                    <input readonly value="@SelectedItem.Category" />
                                </div>
                            </div>

                            <div class="field-row">
                                <div class="field">
                                    <label>Class:</label>
                                    <input readonly value="@SelectedItem.Class" />
                                </div>
                                <div class="field">
                                    <label>Subcategory:</label>
                                    <input readonly value="@SelectedItem.Subcategory" />
                                </div>
                            </div>

                            <div class="field-row">
                                <div class="field">
                                    <label>Ship From:</label>
                                    <input readonly value="@SelectedItem.ShipFrom" />
                                </div>
                                <div class="field">
                                    <label>Brand:</label>
                                    <input readonly value="@SelectedItem.Brand" />
                                </div>
                            </div>

                            <div class="field-row">
                                <div class="field">
                                    <label>Replaced by:</label>
                                    <input readonly value="@SelectedItem.ReplacedBy" />
                                </div>
                                <div class="field">
                                    <label>Supplier:</label>
                                    <input readonly value="@SelectedItem.Supplier" />
                                </div>
                            </div>

                            <div class="field-row">
                                <div class="field">
                                    <label>Buy Qty:</label>
                                    <input readonly value="@SelectedItem.BuyQty" />
                                </div>
                                <div class="field">
                                    <label>Sell Qty:</label>
                                    <input readonly value="@SelectedItem.SellQty" />
                                </div>
                            </div>
                        </div>

                        <!-- Inventory Summary -->
                        <div class="inventory-summary">
                            <div class="inventory-header">Inventory Summary</div>
                            <div class="inventory-grid">
                                <div class="inv-col">
                                    <div class="inv-label">On Hand</div>
                                    <div class="inv-value">@SelectedItem.OnHand</div>
                                </div>
                                <div class="inv-col">
                                    <div class="inv-label">Pending</div>
                                    <div class="inv-value">@SelectedItem.Pending</div>
                                </div>
                                <div class="inv-col">
                                    <div class="inv-label">On Order</div>
                                    <div class="inv-value">@SelectedItem.OnOrder</div>
                                </div>
                                <div class="inv-col">
                                    <div class="inv-label">Alloc</div>
                                    <div class="inv-value">@SelectedItem.Alloc</div>
                                </div>
                                <div class="inv-col">
                                    <div class="inv-label">BKO</div>
                                    <div class="inv-value">@SelectedItem.BKO</div>
                                </div>
                                <div class="inv-col">
                                    <div class="inv-label">In Transit</div>
                                    <div class="inv-value">@SelectedItem.InTransit</div>
                                </div>
                                <div class="inv-col">
                                    <div class="inv-label">Needs</div>
                                    <div class="inv-value">@SelectedItem.Needs</div>
                                </div>
                                <div class="inv-col">
                                    <div class="inv-label">Interests</div>
                                    <div class="inv-value">@SelectedItem.Interests</div>
                                </div>
                            </div>
                        </div>

                        <!-- Pricing Info -->
                        <div class="pricing-section">
                            <div class="pricing-header">Effective Pricing</div>
                            <div class="pricing-grid">
                                <div class="pricing-row">
                                    <span class="pricing-label">Effective:</span>
                                    <span class="pricing-value">@SelectedItem.EffectiveDate?.ToString("MM/dd/yyyy")</span>
                                </div>
                                <div class="pricing-row">
                                    <span class="pricing-label">Local List:</span>
                                    <span class="pricing-value">@SelectedItem.LocalListPrice.ToString("C")</span>
                                </div>
                                <div class="pricing-row">
                                    <span class="pricing-label">Discount:</span>
                                    <span class="pricing-value">@SelectedItem.Discount</span>
                                </div>
                            </div>
                        </div>

                        <!-- Other Inventory Section -->
                        <div class="other-inventory-section">
                            <button class="collapsible-header @(ShowOtherInventory ? "expanded" : "")"
                                    @onclick="() => ShowOtherInventory = !ShowOtherInventory">
                                <span class="chevron">@(ShowOtherInventory ? "▼" : "▶")</span>
                                Other Inventory
                            </button>

                            @if (ShowOtherInventory)
                            {
                                <div class="other-inventory-content">
                                    <div class="inventory-warehouse-section">
                                        <div class="field-row" style="align-items: end; margin-bottom: 1rem;">
                                            <div class="field">
                                                <label>Warehouse</label>
                                                <select @bind="SelectedWarehouse">
                                                    @foreach (var wh in Warehouses)
                                                    {
                                                        <option value="@wh">@wh</option>
                                                    }
                                                </select>
                                            </div>
                                            <div class="field">
                                                <label>Quantity</label>
                                                <input readonly value="@GetWarehouseQuantity(SelectedWarehouse)" />
                                            </div>
                                        </div>

                                        <div class="field-row" style="margin-bottom: 1rem;">
                                            <div class="field">
                                                <label>Stock In Date</label>
                                                <input readonly value="@GetWarehouseStockDate(SelectedWarehouse)" />
                                            </div>
                                            <div class="field">
                                                <label>As Of</label>
                                                <input readonly value="about 13 hours ago" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="shared-dealers-section">
                                        <div class="shared-dealers-header">
                                            <strong>Shared Dealer</strong>
                                            <strong>Quantity</strong>
                                        </div>
                                        @foreach (var dealer in SharedDealers)
                                        {
                                            <div class="shared-dealer-row">
                                                <span>@dealer.Name</span>
                                                <span>@dealer.Quantity</span>
                                            </div>
                                        }
                                    </div>
                                </div>
                            }
                        </div>

                        <!-- Catalog Text -->
                        <div class="catalog-section">
                            <label>Catalog Text:</label>
                            <textarea readonly rows="8">@SelectedItem.CatalogText</textarea>
                        </div>
                    </div>
                }
                else
                {
                    <div class="detail-empty">
                        <p>Select an item to view details</p>
                    </div>
                }
            </div>
        </div>
    </section>
</div>

@code {
    // Enable franchise selector in sidebar
    protected override bool ShowFranchiseSelector => true;

    // ============================================================
    // Page contract & URL bindings
    // ============================================================
    protected override string BasePath => "/product/webcat";

    private string? DealerId;
    private string? Option = "Webcat";
    private string SelectedClass = "All Items";
    private string SelectedCategory = "";
    private string SelectedSubcategory = "";
    private string SelectedBrand = "";
    private string SelectedShipFrom = "";
    private bool DisplayDiscontinued = false;
    private bool OnlyShowInventory = false;
    private string SearchText = "";
    private string? SelectedItemNumber;

    // Track last category to detect category changes coming through the generic handler.
    private string _lastCategory = "";

    // Other Inventory state
    private bool ShowOtherInventory = false;
    private string SelectedWarehouse = "Cornwell";
    private string[] Warehouses => new[] { "Cornwell", "1DC", "2DC", "3DC" };

    protected override IReadOnlyDictionary<string, string?> Scalars =>
        new Dictionary<string, string?>(StringComparer.OrdinalIgnoreCase)
        {
            ["dealer"] = DealerId,
            ["option"] = Option,
            ["class"] = SelectedClass,
            ["category"] = !string.IsNullOrEmpty(SelectedCategory) ? SelectedCategory : null,
            ["subcategory"] = !string.IsNullOrEmpty(SelectedSubcategory) ? SelectedSubcategory : null,
            ["brand"] = !string.IsNullOrEmpty(SelectedBrand) ? SelectedBrand : null,
            ["shipfrom"] = !string.IsNullOrEmpty(SelectedShipFrom) ? SelectedShipFrom : null,
            ["discontinued"] = DisplayDiscontinued ? "true" : null,
            ["inventory"] = OnlyShowInventory ? "true" : null,
            ["item"] = SelectedItemNumber
        };

    protected override IReadOnlyCollection<string> MultiValues => Array.Empty<string>();

    protected override void ReadFromUrl()
    {
        DealerId = Url.Get("dealer");
        Option = Url.Get("option") ?? "Webcat";
        SelectedClass = Url.Get("class") ?? "All Items";
        SelectedCategory = Url.Get("category") ?? "";
        SelectedSubcategory = Url.Get("subcategory") ?? "";
        SelectedBrand = Url.Get("brand") ?? "";
        SelectedShipFrom = Url.Get("shipfrom") ?? "";
        DisplayDiscontinued = Url.Get("discontinued") == "true";
        OnlyShowInventory = Url.Get("inventory") == "true";
        SelectedItemNumber = Url.Get("item");

        // Keep the tracker in sync with the URL state
        _lastCategory = SelectedCategory;

        // If current Subcategory is not valid for the Category in the URL, clear it
        if (!string.IsNullOrEmpty(SelectedSubcategory) &&
            !SubcategoriesForSelectedCategory.Contains(SelectedSubcategory, StringComparer.OrdinalIgnoreCase))
        {
            SelectedSubcategory = "";
        }

        // Select first item if none selected
        if (string.IsNullOrEmpty(SelectedItemNumber))
        {
            SelectedItemNumber = DisplayedItems.FirstOrDefault()?.Item;
        }
    }

    // ============================================================
    // Sidebar facets
    // ============================================================
    protected override IEnumerable<Facet> Facets()
    {
        yield return new Facet(
            Key: "option",
            Title: "Option",
            Options: () => new[]
            {
            new FacetOption("Webcat", "Webcat",
                Href: AppendPreserved(Url.BuildHref("/product/webcat",
                    new Dictionary<string, string?> { ["class"] = "All Items" }))),

            new FacetOption("Set Maintenance", "Set Maintenance",
                Href: AppendPreserved(Url.BuildHref("/product/set-maintenance",
                    new Dictionary<string, string?> { ["class"] = "All Items" }))),

            new FacetOption("View/Change Prices", "View/Change Prices",
                Href: AppendPreserved(Url.BuildHref("/product/prices",
                    new Dictionary<string, string?> { ["class"] = "All Items" })))
            }
        );

        yield return CommonFacets.ClassFacet;

        yield return CommonFacets.ItemLegend;
    }

    // ============================================================
    // Lifecycle
    // ============================================================
    protected override void OnInitialized()
    {
        SeedData();
        base.OnInitialized();
    }

    // ============================================================
    // Data & Filtering
    // ============================================================
    private List<WebcatItem> AllItems = new();

    private readonly string[] Categories = new[] { "Drive Tools", "Hand Tools", "Power Tools", "Storage", "Diagnostics" };

    // Dynamic, data-driven subcategories for the currently selected Category
    private IReadOnlyList<string> SubcategoriesForSelectedCategory =>
        string.IsNullOrEmpty(SelectedCategory)
            ? Array.Empty<string>()
            : AllItems
                .Where(x => string.Equals(x.Category, SelectedCategory, StringComparison.OrdinalIgnoreCase))
                .Select(x => x.Subcategory)
                .Where(s => !string.IsNullOrWhiteSpace(s))
                .Distinct(StringComparer.OrdinalIgnoreCase)
                .OrderBy(s => s)
                .ToList();

    public readonly IReadOnlyList<string> Brands = new[]
    {
        "Bosch",
        "Cornwell Quality Tools",
        "DeWalt",
        "Fluke",
        "Generic",
        "Knipex",
        "Makita",
        "Mechanix Wear",
        "Milwaukee"
    };

    private readonly string[] ShipFromLocations = new[] { "CQT", "1DC", "2DC", "3DC" };

    private List<WebcatItem> FilteredItems
    {
        get
        {
            var query = AllItems.AsEnumerable();

            if (SelectedClass != "All Items")
                query = query.Where(x => x.Class == SelectedClass);

            if (!string.IsNullOrEmpty(SelectedCategory))
                query = query.Where(x => x.Category == SelectedCategory);

            if (!string.IsNullOrEmpty(SelectedSubcategory))
                query = query.Where(x => x.Subcategory == SelectedSubcategory);

            if (!string.IsNullOrEmpty(SelectedBrand))
                query = query.Where(x => x.Brand == SelectedBrand);

            if (!string.IsNullOrEmpty(SelectedShipFrom))
                query = query.Where(x => x.ShipFrom == SelectedShipFrom);

            if (!DisplayDiscontinued)
                query = query.Where(x => !x.IsDiscontinued);

            if (OnlyShowInventory)
                query = query.Where(x => x.OnHand > 0);

            return query.ToList();
        }
    }

    private List<WebcatItem> DisplayedItems
    {
        get
        {
            var items = FilteredItems;

            if (!string.IsNullOrEmpty(SearchText))
            {
                var search = SearchText.ToLower();
                items = items.Where(x =>
                    x.Item.ToLower().Contains(search) ||
                    x.Description.ToLower().Contains(search)
                ).ToList();
            }

            return items;
        }
    }

    private WebcatItem? SelectedItem =>
        DisplayedItems.FirstOrDefault(x => x.Item == SelectedItemNumber);

    // ============================================================
    // Other Inventory Data
    // ============================================================
    private sealed class SharedDealer
    {
        public string Name { get; set; } = "";
        public int Quantity { get; set; }
    }

    private List<SharedDealer> SharedDealers => new()
    {
        new SharedDealer { Name = "Donald D. Bricker", Quantity = 0 },
        new SharedDealer { Name = "Shawn M. Lewis", Quantity = 0 },
        new SharedDealer { Name = "Donald W. Muffley", Quantity = 0 }
    };

    private int GetWarehouseQuantity(string warehouse) => 0;
    private string GetWarehouseStockDate(string warehouse) => "";

    // ============================================================
    // Actions
    // ============================================================
    private void SelectItem(string itemNumber)
    {
        SelectedItemNumber = itemNumber;
        NavigateWithPageState();
    }

    private void OnFilterChanged()
    {
        // If Category changed, ensure Subcategory is valid for the new Category
        if (!string.Equals(_lastCategory, SelectedCategory, StringComparison.OrdinalIgnoreCase))
        {
            // If the selected subcategory isn't in the new list, clear it
            if (!string.IsNullOrEmpty(SelectedSubcategory) &&
                !SubcategoriesForSelectedCategory.Contains(SelectedSubcategory, StringComparer.OrdinalIgnoreCase))
            {
                SelectedSubcategory = "";
            }

            _lastCategory = SelectedCategory;
        }

        // Reset item selection when filters change
        SelectedItemNumber = DisplayedItems.FirstOrDefault()?.Item;

        // Push URL state
        NavigateWithPageState();
    }

    private void ClearFilters()
    {
        SelectedClass = "All Items";
        SelectedCategory = "";
        _lastCategory = "";          // keep tracker consistent
        SelectedSubcategory = "";
        SelectedBrand = "";
        SelectedShipFrom = "";
        DisplayDiscontinued = false;
        OnlyShowInventory = false;
        SearchText = "";

        SelectedItemNumber = DisplayedItems.FirstOrDefault()?.Item;
        NavigateWithPageState(replace: true);
    }

    private string GetItemStatusClass(WebcatItem item)
    {
        var classes = new List<string>();
        if (item.IsDiscontinued) classes.Add("item-discontinued");
        if (item.IsPriceConfirm) classes.Add("item-price");
        if (item.IsDropShip) classes.Add("item-ds");
        return string.Join(" ", classes);
    }

    // ============================================================
    // Data seeding
    // ============================================================
    private void SeedData()
    {
        AllItems = WebcatSeedData.GetItems();
    }
}

<style>
    .filter-panel {
        margin-bottom: 1rem;
    }

    .filter-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        padding: 1rem;
    }

    .filter-col {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .checkbox-field {
        display: flex;
        align-items: center;
    }

        .checkbox-field label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            margin: 0;
        }

        .checkbox-field input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

    .filter-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        border-top: 1px solid #dee2e6;
        background: #f8f9fa;
    }

    .filter-summary {
        font-weight: 600;
        color: #6c757d;
    }

    .items-section {
        padding: 0;
    }

    .items-layout {
        display: grid;
        grid-template-columns: 300px 1fr;
        min-height: 600px;
    }

    .items-list {
        border-right: 1px solid #dee2e6;
        display: flex;
        flex-direction: column;
    }

    .list-header {
        padding: 1rem;
        border-bottom: 1px solid #dee2e6;
        background: #f8f9fa;
    }

    .search-box {
        width: 100%;
        padding: 0.5rem;
        border: 1px solid #dee2e6;
        border-radius: 0.25rem;
    }

    .list-body {
        flex: 1;
        overflow-y: auto;
        max-height: 600px;
    }

    .item-row {
        display: flex;
        align-items: center;
        padding: 0.75rem 1rem;
        border-bottom: 1px solid #f0f0f0;
        cursor: pointer;
        gap: 0.5rem;
        position: relative;
    }

        .item-row:hover {
            background-color: #f8f9fa;
        }

        .item-row.selected {
            background-color: #e7f3ff;
            border-left: 3px solid #007bff;
        }

        .item-row.item-discontinued {
            color: #6c757d;
        }

    .item-number {
        font-weight: 600;
        min-width: 120px;
    }

    .item-name {
        flex: 1;
        font-size: 0.875rem;
    }

    .item-badge {
        font-size: 1.2em;
        line-height: 1;
    }

        .item-badge.disc {
            color: #e11d48;
        }

        .item-badge.price {
            color: #111827;
        }

        .item-badge.ds {
            color: #f59e0b;
        }

    .item-detail {
        padding: 1.5rem;
        overflow-y: auto;
        max-height: 600px;
    }

    .detail-empty {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        color: #6c757d;
    }

    .detail-header h4 {
        margin: 0 0 1.5rem 0;
        padding-bottom: 0.75rem;
        border-bottom: 2px solid #dee2e6;
    }

    .detail-grid {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .detail-section {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .field-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
    }

    .inventory-summary {
        border: 1px solid #dee2e6;
        border-radius: 0.25rem;
        overflow: hidden;
    }

    .inventory-header {
        background: #007bff;
        color: white;
        padding: 0.5rem 1rem;
        font-weight: 600;
    }

    .inventory-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1px;
        background: #dee2e6;
        padding: 1px;
    }

    .inv-col {
        background: white;
        padding: 0.75rem;
        text-align: center;
    }

    .inv-label {
        font-size: 0.75rem;
        color: #6c757d;
        margin-bottom: 0.25rem;
    }

    .inv-value {
        font-size: 1.25rem;
        font-weight: 600;
        color: #212529;
    }

    .pricing-section {
        border: 1px solid #dee2e6;
        border-radius: 0.25rem;
        overflow: hidden;
    }

    .pricing-header {
        background: #007bff;
        color: white;
        padding: 0.5rem 1rem;
        font-weight: 600;
    }

    .pricing-grid {
        padding: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .pricing-row {
        display: flex;
        justify-content: space-between;
    }

    .pricing-label {
        font-weight: 600;
        color: #6c757d;
    }

    .pricing-value {
        font-weight: 600;
    }

    .other-inventory-section {
        border: 1px solid #dee2e6;
        border-radius: 0.25rem;
        overflow: hidden;
    }

    .collapsible-header {
        width: 100%;
        background: #f8f9fa;
        border: none;
        padding: 0.75rem 1rem;
        text-align: left;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
        transition: background-color 0.2s;
    }

        .collapsible-header:hover {
            background: #e9ecef;
        }

        .collapsible-header.expanded {
            background: #e9ecef;
            border-bottom: 1px solid #dee2e6;
        }

    .chevron {
        font-size: 0.75em;
        color: #6c757d;
    }

    .other-inventory-content {
        padding: 1rem;
        background: white;
    }

    .inventory-warehouse-section {
        margin-bottom: 1.5rem;
    }

    .shared-dealers-section {
        border-top: 1px solid #dee2e6;
        padding-top: 1rem;
    }

    .shared-dealers-header {
        display: grid;
        grid-template-columns: 1fr 100px;
        padding: 0.5rem;
        background: #f8f9fa;
        font-weight: 600;
        border-radius: 0.25rem;
        margin-bottom: 0.5rem;
    }

    .shared-dealer-row {
        display: grid;
        grid-template-columns: 1fr 100px;
        padding: 0.5rem;
        border-bottom: 1px solid #f0f0f0;
    }

        .shared-dealer-row:last-child {
            border-bottom: none;
        }

        .shared-dealer-row span:last-child {
            text-align: right;
        }

    .catalog-section {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

        .catalog-section textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #dee2e6;
            border-radius: 0.25rem;
            resize: vertical;
            font-family: inherit;
        }
</style>
